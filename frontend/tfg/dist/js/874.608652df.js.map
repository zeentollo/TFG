{"version":3,"file":"js/874.608652df.js","mappings":"ktCA+CA,MAAMA,GAAgBC,EAAAA,EAAAA,IAAI,IACpBC,GAAiBD,EAAAA,EAAAA,IAAI,IACrBE,GAAkBF,EAAAA,EAAAA,IAAI,IAEtBG,GAASC,EAAAA,EAAAA,MACTC,GAASC,EAAAA,EAAAA,MAETC,GAAqBC,EAAAA,EAAAA,KAAS,IAAML,EAAMM,MAAMF,qBAEhDG,GAAQF,EAAAA,EAAAA,KAAS,IACdD,EAAmBI,MAAMC,QAAO,CAACC,EAAKC,IAASD,EAAME,SAASD,EAAKE,SAASC,QAAQ,KAGvFC,GAAclB,EAAAA,EAAAA,IAAI,IAClBmB,EAAqBA,KACzB,MAAMC,EAAM,IAAIC,KACVC,EAAMC,OAAOH,EAAII,WAAWC,SAAS,EAAG,KACxCC,EAAMH,OAAOH,EAAIO,WAAa,GAAGF,SAAS,EAAG,KAC7CG,EAAMR,EAAIS,cAChB,MAAQ,GAAEP,KAAOI,KAAOE,GAAK,GAG/BE,EAAAA,EAAAA,KAAU,KACRZ,EAAYP,MAAQQ,GAAoB,IAG1C,MAAMY,EAAcC,UAClB,IAAKjC,EAAcY,QAAUV,EAAeU,QAAUT,EAAgBS,MAMpE,YALAsB,IAAAA,KAAU,CACRC,KAAM,QACNC,MAAO,gBACPC,KAAM,0CAKV,MAAMC,EAAgB,WACtB,IAAKA,EAAcC,KAAKvC,EAAcY,OAMpC,YALAsB,IAAAA,KAAU,CACRC,KAAM,QACNC,MAAO,iBACPC,KAAM,4DAKV,GAAI,IAAIf,KAAKpB,EAAeU,QAAU,IAAIU,KAMxC,YALAY,IAAAA,KAAU,CACRC,KAAM,QACNC,MAAO,iBACPC,KAAM,yDAKV,MAAMG,EAAe,UACrB,IAAKA,EAAaD,KAAKpC,EAAgBS,OAMrC,YALAsB,IAAAA,KAAU,CACRC,KAAM,QACNC,MAAO,iBACPC,KAAM,6DAKV,MAAMI,GAAOhC,EAAAA,EAAAA,KAAS,IAAML,EAAMsC,QAAQC,WACpCnC,GAAqBC,EAAAA,EAAAA,KAAS,IAAOL,EAAMsC,QAAQE,0BACnDjC,GAAQF,EAAAA,EAAAA,KAAS,IACdD,EAAmBI,MAAMC,QAAO,CAACC,EAAKC,IAASD,EAAME,SAASD,EAAKE,SAASC,QAAQ,KAEvF2B,EAAc,GACpBrC,EAAmBI,MAAMkC,SAAQ7B,IAC/B4B,EAAYE,KAAK9B,EAASA,SAAS+B,GAAG,IAGxC,MAAMC,QAAqBC,EAAAA,EAAMC,KAAK,6CAA8C,CAACV,KAAMA,EAAK7B,MAAOD,MAAOA,EAAMC,MAAOwC,UAAWP,GAAc,CAClJQ,QAAS,CACP,eAAgB,sBAGpBjD,EAAMkD,OAAO,YAAaL,EAAaM,MACvCrB,IAAAA,KAAU,CACRC,KAAM,UACNC,MAAO,gBACPC,KAAM,0CAER/B,EAAOyC,KAAK,WAAW,EAInBS,EAAWA,KACblD,EAAOyC,KAAK,UAAU,E,g4BCpI1B,MAAMU,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://tfg/./src/views/PagoView.vue","webpack://tfg/./src/views/PagoView.vue?9d0e"],"sourcesContent":["<template>\r\n    <section id=\"principal\">\r\n        <section id=\"info\">\r\n            <p class=\"text_info\">IMPORTE</p>\r\n            <p class=\"text_info\">{{ total }} €</p>\r\n\r\n            <div id=\"div_info\">\r\n                <p class=\"text_div\">COMERCIO: MATTEO RICCI</p>\r\n                <p class=\"text_div\">TERMINAL: 5675788978-RJ</p>\r\n                <p class=\"text_div\">FECHA: {{ fechaActual }}</p>\r\n            </div>\r\n        </section>\r\n\r\n        <section id=\"inputs\">\r\n            <p id=\"texto\">PAGO CON TARJETA</p>\r\n            <div id=\"div_inputs\">\r\n                <i id=\"iconos\" class=\"fa-regular fa-credit-card\"></i><p>Nº DE TARJETA</p>\r\n            </div>\r\n            <input v-model=\"numeroTarjeta\" type=\"text\" name=\"\" id=\"input\" placeholder=\"0000 0000 0000 0000\" maxlength=\"16\"><br>\r\n            \r\n            <div id=\"div_inputs\">\r\n                <i id=\"iconos\" class=\"fa-regular fa-calendar\"></i><p>FECHA DE CADUCIDAD</p>\r\n            </div>\r\n            <input v-model=\"fechaCaducidad\" type=\"date\" name=\"\" id=\"input\"><br>\r\n\r\n            <div id=\"div_inputs\">\r\n                <i id=\"iconos\" class=\"fa-solid fa-credit-card\"></i><p>COD. DE SEGURIDAD</p>\r\n            </div>\r\n            <input v-model=\"codigoSeguridad\" type=\"text\" name=\"\" id=\"input\" placeholder=\"000\" maxlength=\"3\">\r\n\r\n            <div id=\"div_botones\">\r\n                <button @click=\"validarPago\" class=\"botones\" id=\"pagar\">PAGAR</button>\r\n                <button @click=\"cancelar\" class=\"botones\" id=\"cancelar\">CANCELAR</button>\r\n            </div>\r\n\r\n        </section>\r\n\r\n    </section>\r\n</template>\r\n\r\n<script setup>\r\nimport Swal from 'sweetalert2';\r\nimport { ref, computed, onMounted } from 'vue';\r\nimport axios from 'axios';\r\nimport { useRouter } from 'vue-router'\r\nimport { useStore } from 'vuex'\r\n\r\nconst numeroTarjeta = ref('')\r\nconst fechaCaducidad = ref('')\r\nconst codigoSeguridad = ref('')\r\n\r\nconst store =  useStore()\r\nconst router = useRouter()\r\n\r\nconst productosEnCarrito = computed(() => store.state.productosEnCarrito);\r\n\r\nconst total = computed(() => {\r\n  return productosEnCarrito.value.reduce((sum, item) => sum + parseInt(item.producto.price), 0);\r\n});\r\n\r\nconst fechaActual = ref('')\r\nconst ObtenerFechaActual = () => {\r\n  const hoy = new Date()\r\n  const dia = String(hoy.getDate()).padStart(2, '0')\r\n  const mes = String(hoy.getMonth() + 1).padStart(2, '0')\r\n  const ano = hoy.getFullYear()\r\n  return `${dia}/${mes}/${ano}`\r\n}\r\n\r\nonMounted(() => {\r\n  fechaActual.value = ObtenerFechaActual()\r\n})\r\n\r\nconst validarPago = async () => {\r\n  if (!numeroTarjeta.value || !fechaCaducidad.value || !codigoSeguridad.value) {\r\n    Swal.fire({\r\n      icon: 'error',\r\n      title: 'Campos vacíos',\r\n      text: 'Por favor, completa todos los campos.'\r\n    });\r\n    return;\r\n  }\r\n\r\n  const tarjetaValida = /^\\d{16}$/;\r\n  if (!tarjetaValida.test(numeroTarjeta.value)) {\r\n    Swal.fire({\r\n      icon: 'error',\r\n      title: 'Datos erróneos',\r\n      text: 'El número de tarjeta debe contener 16 dígitos numéricos'\r\n    });\r\n    return;\r\n  }\r\n\r\n  if (new Date(fechaCaducidad.value) <= new Date()) {\r\n    Swal.fire({\r\n      icon: 'error',\r\n      title: 'Datos erróneos',\r\n      text: 'La fecha de caducidad debe ser posterior a la actual'\r\n    });\r\n    return;\r\n  }\r\n\r\n  const codigoValido = /^\\d{3}$/;\r\n  if (!codigoValido.test(codigoSeguridad.value)) {\r\n    Swal.fire({\r\n      icon: 'error',\r\n      title: 'Datos erróneos',\r\n      text: 'El código de seguridad debe contener 3 dígitos numéricos'\r\n    });\r\n    return;\r\n  }\r\n\r\n  const user = computed(() => store.getters.nombreId)\r\n  const productosEnCarrito = computed(() =>  store.getters.listaProductosEnCarrito)\r\n  const total = computed(() => {\r\n    return productosEnCarrito.value.reduce((sum, item) => sum + parseInt(item.producto.price), 0);\r\n  });\r\n  const productosId = []\r\n  productosEnCarrito.value.forEach(producto => {\r\n    productosId.push(producto.producto.id)\r\n  });\r\n\r\n  const crearFactura = await axios.post(\"https://tfg-izsx.onrender.com:3000/factura\", {user: user.value, total: total.value, productos: productosId}, {\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n  });\r\n  store.commit(\"esFactura\", crearFactura.data)\r\n  Swal.fire({\r\n    icon: 'success',\r\n    title: 'Pago correcto',\r\n    text: 'Se ha procesado tu pago correctamente'\r\n  });\r\n  router.push(\"/factura\")\r\n}\r\n\r\n\r\nconst cancelar = () => {\r\n    router.push(\"/compra\")\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n#principal {\r\n    background-image: url(\"@/assets/img/fondo.jpg\");\r\n    background-size: cover;\r\n    background-position: center;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n}\r\n\r\n#info{\r\n    background-color: #F5F5F5;\r\n    font-size: 36px;\r\n    padding: 40px;\r\n    padding-bottom: 140px;\r\n    margin: 50px;\r\n    margin-top: 120px;\r\n}\r\n.text_info{\r\n    font-weight: bold;\r\n    margin: 40px;\r\n    margin-left: 20px;\r\n}\r\n\r\n.text_div{\r\n    font-weight: 200;\r\n    margin: 20px;\r\n}\r\n\r\n#inputs{\r\n    font-size: 30px;\r\n}\r\n\r\n#texto{\r\n    margin-bottom: 40px;\r\n    font-size: 48px;\r\n    margin-top: 100px;\r\n}\r\n\r\n#div_inputs{\r\n    display: flex;\r\n}\r\n\r\n#input{\r\n    margin-bottom: 60px;\r\n    margin-top: 30px;\r\n    width: 100vh;\r\n    height: 40px;\r\n    border: 1px solid;\r\n    background-color: #F2F2F2;\r\n    padding: 10px;\r\n    letter-spacing: 6px;\r\n    font-size: 32px;\r\n}\r\n\r\n#iconos{\r\n    margin-right: 20px;\r\n}\r\n\r\n#div_botones{\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: 400px;\r\n    margin-bottom: 20px;\r\n}\r\n\r\n.botones{\r\n    width: 30vh;\r\n    height: 60px;\r\n    border: 1px solid;\r\n    background-color: #F2F2F2;\r\n    padding: 10px;\r\n    letter-spacing: 4px;\r\n    font-size: 22px;\r\n    font-weight: bold;\r\n    margin-bottom: 50px;\r\n}\r\n\r\n#pagar{\r\n    background-color: #39B8FF;\r\n    color: #FFFFFF;\r\n}\r\n\r\n#pagar:hover{\r\n    background-color: #39B8FF;\r\n    color: #92ffa8;\r\n    cursor: pointer;\r\n}\r\n\r\n#cancelar{\r\n    background-color: #636363;\r\n    color: #FFFFFF;\r\n}\r\n\r\n#cancelar:hover{\r\n    color: #ff7171;\r\n    cursor: pointer;\r\n}\r\n</style>\r\n","import script from \"./PagoView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./PagoView.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./PagoView.vue?vue&type=style&index=0&id=1d5e825b&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1d5e825b\"]])\n\nexport default __exports__"],"names":["numeroTarjeta","ref","fechaCaducidad","codigoSeguridad","store","useStore","router","useRouter","productosEnCarrito","computed","state","total","value","reduce","sum","item","parseInt","producto","price","fechaActual","ObtenerFechaActual","hoy","Date","dia","String","getDate","padStart","mes","getMonth","ano","getFullYear","onMounted","validarPago","async","Swal","icon","title","text","tarjetaValida","test","codigoValido","user","getters","nombreId","listaProductosEnCarrito","productosId","forEach","push","id","crearFactura","axios","post","productos","headers","commit","data","cancelar","__exports__"],"sourceRoot":""}