"use strict";(self["webpackChunktfg"]=self["webpackChunktfg"]||[]).push([[874],{874:function(e,t,a){a.r(t),a.d(t,{default:function(){return w}});a(4114);var o=a(6768),i=a(4232),r=a(5130),n=a(4874),s=a.n(n),d=a(144),l=a(4373),c=a(1387),u=a(782);const p=e=>((0,o.Qi)("data-v-1d5e825b"),e=e(),(0,o.jt)(),e),v={id:"principal"},f={id:"info"},k=p((()=>(0,o.Lk)("p",{class:"text_info"},"IMPORTE",-1))),L={class:"text_info"},E={id:"div_info"},g=p((()=>(0,o.Lk)("p",{class:"text_div"},"COMERCIO: MATTEO RICCI",-1))),m=p((()=>(0,o.Lk)("p",{class:"text_div"},"TERMINAL: 5675788978-RJ",-1))),C={class:"text_div"},b={id:"inputs"},A=p((()=>(0,o.Lk)("p",{id:"texto"},"PAGO CON TARJETA",-1))),h=p((()=>(0,o.Lk)("div",{id:"div_inputs"},[(0,o.Lk)("i",{id:"iconos",class:"fa-regular fa-credit-card"}),(0,o.Lk)("p",null,"Nº DE TARJETA")],-1))),x=p((()=>(0,o.Lk)("br",null,null,-1))),D=p((()=>(0,o.Lk)("div",{id:"div_inputs"},[(0,o.Lk)("i",{id:"iconos",class:"fa-regular fa-calendar"}),(0,o.Lk)("p",null,"FECHA DE CADUCIDAD")],-1))),_=p((()=>(0,o.Lk)("br",null,null,-1))),R=p((()=>(0,o.Lk)("div",{id:"div_inputs"},[(0,o.Lk)("i",{id:"iconos",class:"fa-solid fa-credit-card"}),(0,o.Lk)("p",null,"COD. DE SEGURIDAD")],-1)));var I={__name:"PagoView",setup(e){const t=(0,d.KR)(""),a=(0,d.KR)(""),n=(0,d.KR)(""),p=(0,u.Pj)(),I=(0,c.rd)(),T=(0,o.EW)((()=>p.state.productosEnCarrito)),P=(0,o.EW)((()=>T.value.reduce(((e,t)=>e+parseInt(t.producto.price)),0))),w=(0,d.KR)(""),O=()=>{const e=new Date,t=String(e.getDate()).padStart(2,"0"),a=String(e.getMonth()+1).padStart(2,"0"),o=e.getFullYear();return`${t}/${a}/${o}`};(0,o.sV)((()=>{w.value=O()}));const J=async()=>{if(!t.value||!a.value||!n.value)return void s().fire({icon:"error",title:"Campos vacíos",text:"Por favor, completa todos los campos."});const e=/^\d{16}$/;if(!e.test(t.value))return void s().fire({icon:"error",title:"Datos erróneos",text:"El número de tarjeta debe contener 16 dígitos numéricos"});if(new Date(a.value)<=new Date)return void s().fire({icon:"error",title:"Datos erróneos",text:"La fecha de caducidad debe ser posterior a la actual"});const i=/^\d{3}$/;if(!i.test(n.value))return void s().fire({icon:"error",title:"Datos erróneos",text:"El código de seguridad debe contener 3 dígitos numéricos"});const r=(0,o.EW)((()=>p.getters.nombreId)),d=(0,o.EW)((()=>p.getters.listaProductosEnCarrito)),c=(0,o.EW)((()=>d.value.reduce(((e,t)=>e+parseInt(t.producto.price)),0))),u=[];d.value.forEach((e=>{u.push(e.producto.id)}));const v=await l.A.post("https://tfg-izsx.onrender.com:3000/factura",{user:r.value,total:c.value,productos:u},{headers:{"Content-Type":"application/json"}});p.commit("esFactura",v.data),s().fire({icon:"success",title:"Pago correcto",text:"Se ha procesado tu pago correctamente"}),I.push("/factura")},S=()=>{I.push("/compra")};return(e,s)=>((0,o.uX)(),(0,o.CE)("section",v,[(0,o.Lk)("section",f,[k,(0,o.Lk)("p",L,(0,i.v_)(P.value)+" €",1),(0,o.Lk)("div",E,[g,m,(0,o.Lk)("p",C,"FECHA: "+(0,i.v_)(w.value),1)])]),(0,o.Lk)("section",b,[A,h,(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>t.value=e),type:"text",name:"",id:"input",placeholder:"0000 0000 0000 0000",maxlength:"16"},null,512),[[r.Jo,t.value]]),x,D,(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>a.value=e),type:"date",name:"",id:"input"},null,512),[[r.Jo,a.value]]),_,R,(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>n.value=e),type:"text",name:"",id:"input",placeholder:"000",maxlength:"3"},null,512),[[r.Jo,n.value]]),(0,o.Lk)("div",{id:"div_botones"},[(0,o.Lk)("button",{onClick:J,class:"botones",id:"pagar"},"PAGAR"),(0,o.Lk)("button",{onClick:S,class:"botones",id:"cancelar"},"CANCELAR")])])]))}},T=a(1241);const P=(0,T.A)(I,[["__scopeId","data-v-1d5e825b"]]);var w=P}}]);
//# sourceMappingURL=874.608652df.js.map